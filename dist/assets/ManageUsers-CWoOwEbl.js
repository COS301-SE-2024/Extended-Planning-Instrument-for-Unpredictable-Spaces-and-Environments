import{m as P,u as I,r as m,p as V,d as h,c as F,e as l,h as o,n as r,f as t,i as b,F as C,o as U,k as f}from"./index-D69WjGrQ.js";import{_ as M}from"./Sidebar-PMHBK9mK.js";const J={class:"flex flex-col p-4 ml-2 w-full"},S={class:"w-full md:w-[300px] mb-4"},T=l("span",{class:"font-bold"},"Manage User's",-1),D=[T],O={class:"p-fluid"},R={class:"field"},z=l("label",{for:"FullName",class:"py-2"},"Full Name",-1),A={class:"field"},B=l("label",{for:"Email"},"Email",-1),W={class:"field"},X=l("label",{for:"Role"},"Role",-1),Y={class:"field"},j=l("label",{for:"Phone"},"Phone Number",-1),Z={class:"p-d-flex p-jc-end"},G="https://rgisazefakhdieigrylb.supabase.co",Q="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJnaXNhemVmYWtoZGllaWdyeWxiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTYzMTMxNTEsImV4cCI6MjAzMTg4OTE1MX0.xNhTpM5Qxz8sHW0JPFSoFaWAtI425QPoI17jofYxoFA",q={__name:"ManageUsers",setup($){const g=P(G,Q),i=I(),p=m([]),_=async()=>{try{const{data:s,error:e}=await g.functions.invoke("core",{body:JSON.stringify({type:"GetAllUsers"}),method:"POST"});e?console.log("API Error:",e):(p.value=JSON.parse(s).data,console.log(p.value))}catch(s){console.error("Error fetching data:",s)}};V(_);const d=m(!1),n=m({FullName:"",Email:"",Role:"",Phone:""}),c=m(null),x=s=>{n.value={...s},c.value=w.value.find(e=>e.name===s.Role)||null,d.value=!0},w=m([{name:"Manager",code:"Manager"},{name:"Packer",code:"Packer"},{name:"Driver",code:"Driver"},{name:"unassigned",code:"unassigned"}]),y=async()=>{console.log("User details saved:",n.value),d.value=!1;try{console.log(FullName.value),console.log(Email.value),console.log(c.value),console.log(Phone.value);const{data:s,error:e}=await g.functions.invoke("core",{body:JSON.stringify({type:"UpdateUser",fullname:FullName.value,email:Email.value,role:c.value.name,phone:Phone.value}),method:"POST"});e?(console.log("API Error:",e),console.log(e.message)):(console.log(p.value),await _())}catch(s){console.error("Error fetching data:",s)}};return(s,e)=>{const u=h("Column"),v=h("Button"),k=h("DataTable"),E=h("Dropdown"),N=h("Dialog");return U(),F(C,null,[l("div",{class:r([t(i)?"dark bg-neutral-900 text-white":"bg-gray-100 text-black","w-full h-full flex flex-row shadow-lg"])},[o(M),l("div",J,[l("div",S,[l("div",{class:r([t(i)?"border-neutral-500 bg-neutral-900 text-white":"border-gray-500 bg-white text-black","border flex items-center px-4 py-2 rounded-xl focus-within:ring-2 focus-within:ring-yellow-600"])},[l("i",{class:r([t(i)?"text-white":"text-black","pi pi-search mr-2"])},null,2),o(t(f),{placeholder:"Search",class:r([t(i)?"bg-neutral-900 text-white":"bg-white text-black","focus:outline-none focus:ring-0"])},null,8,["class"])],2)]),l("h2",{class:r([t(i)?"text-white":"text-black","my-4 font-normal text-3xl"])},D,2),l("div",null,[o(k,{class:r([t(i)?"dark":""]),value:p.value,paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50]},{default:b(()=>[o(u,{field:"FullName",header:"Full Name",style:{width:"25%"}}),o(u,{field:"Email",header:"Email",style:{width:"25%"}}),o(u,{field:"Role",header:"Role",style:{width:"25%"}}),o(u,{field:"Phone",header:"Phone Number",style:{width:"25%"}}),o(u,{header:"Edit",style:{width:"25%"}},{body:b(a=>[o(v,{class:"bg-yellow-600 text-white",label:"Edit",onClick:L=>x(a.data)},null,8,["onClick"])]),_:1})]),_:1},8,["class","value"])])])],2),o(N,{header:"Edit User",visible:d.value,"onUpdate:visible":e[5]||(e[5]=a=>d.value=a),modal:!0,closable:!1},{default:b(()=>[l("div",O,[l("div",R,[z,o(t(f),{modelValue:n.value.FullName,"onUpdate:modelValue":e[0]||(e[0]=a=>n.value.FullName=a),id:"FullName"},null,8,["modelValue"])]),l("div",A,[B,o(t(f),{modelValue:n.value.Email,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.Email=a),id:"Email"},null,8,["modelValue"])]),l("div",W,[X,o(E,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=a=>c.value=a),options:w.value,optionLabel:"name",placeholder:"Select a Role",class:"w-full md:w-14rem"},null,8,["modelValue","options"])]),l("div",Y,[j,o(t(f),{modelValue:n.value.Phone,"onUpdate:modelValue":e[3]||(e[3]=a=>n.value.Phone=a),id:"Phone"},null,8,["modelValue"])])]),l("div",Z,[o(v,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:e[4]||(e[4]=a=>d.value=!1)}),o(v,{label:"Save",icon:"pi pi-check",class:"p-ml-2",onClick:y})])]),_:1},8,["visible"])],64)}}};export{q as default};
